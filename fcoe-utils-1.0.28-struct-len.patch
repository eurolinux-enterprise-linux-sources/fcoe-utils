diff --git a/lib/rtnetlink.c b/lib/rtnetlink.c
index ddaeb16..abe000e 100644
--- a/lib/rtnetlink.c
+++ b/lib/rtnetlink.c
@@ -89,7 +89,7 @@ ssize_t send_getlink_dump(int s)
 		struct ifinfomsg ifm;
 	} req = {
 		.nh = {
-			.nlmsg_len = NLMSG_LENGTH(sizeof(struct ifinfomsg)),
+			.nlmsg_len = NLMSG_LENGTH(sizeof(struct rtgenmsg)),
 			.nlmsg_type = RTM_GETLINK,
 			.nlmsg_flags = NLM_F_REQUEST | NLM_F_DUMP,
 		},
